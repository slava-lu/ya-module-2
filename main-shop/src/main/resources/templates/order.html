<!DOCTYPE html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<meta charset="utf-8">

<head>
    <title>Заказ</title>
    <style>
        .menu { width:100%; }
        .menu > * { float: right; margin-left: 12px; }
        .btn-link {
            background: none; border: none; padding: 0; margin: 0;
            font: inherit; color: inherit; cursor: pointer; text-decoration: underline;
        }
        .clearfix::after { content: ""; display: table; clear: both; }
    </style>
</head>
<body>
<nav class="menu clearfix">
    <form sec:authorize="isAuthenticated()"
          th:action="@{/logout}" method="post" style="display:inline;">
        <button class="btn-link"><b>ВЫЙТИ &cudarrr;</b></button>
    </form>

    <a sec:authorize="isAnonymous()" th:href="@{/login}">
        <b>ВОЙТИ &cudarrr;</b>
    </a>
>
    <a sec:authorize="isAuthenticated()" href="/orders"><b>ЗАКАЗЫ &cudarrr;</b></a>

    <a sec:authorize="isAuthenticated()" href="/cart/items"><b>КОРЗИНА &cudarrr;</b></a>

    <a href="/main/items"><b>ГЛАВНАЯ &cudarrr;</b></a>
</nav>

<h1 style="text-align:center" th:if="${newOrder}">Поздравляем! Успешная покупка! &#128578;</h1>
<table style="width:70%;margin-left:auto;margin-right:auto;">
    <tr>
        <td>
            <h2 th:text="${'Заказ №'+order.id()}"></h2>
        </td>
    </tr>
    <tr th:each="item : ${order.items()}">
        <td>
            <table>
                <tr>
                    <td>
                        <a th:href="${'/items/'+item.getId()}">
                            <img width="300" height="300" th:src="${'http://localhost:8080/'+item.getImgPath()}">
                        </a>
                    </td>
                </tr>
                <tr>
                    <td>
                        <b th:text="${item.getTitle()}"></b>
                    </td>
                    <td>
                        <b th:text="${item.getCount()}+' шт.'"></b>
                    </td>
                    <td>
                        <b th:text="${item.getPrice()*item.getCount()}+' руб.'"></b>
                    </td>
                </tr>
            </table>
        </td>
    </tr>
    <tr>
        <td>
            <h3 th:text="${'Сумма: '+order.totalSum()}+' руб.'"></h3>
        </td>
    </tr>
</table>
</body>

</html>
